#include "/Users/calhoun/Work/CollageScript/lib/Include.jsx";app.preferences.rulerUnits = Units.CM;  var APPLICATION_ROOT = '/Users/calhoun/Work/VP-Valensole-Doors';//var PALETTE = '/Users/calhoun/Work/KAP/tree-038/smobs';var canvas = new CanvasGrid();canvas.setCanvasRoot(APPLICATION_ROOT);canvas.setName('vp-doors.psd');canvas.setUnits(Units.CM);canvas.setWidth(300);canvas.setHeight(200);canvas.setResolution(30);canvas.setDocumentMode(NewDocumentMode.RGB);canvas.setDocumentFill(DocumentFill.WHITE);canvas.setBitDepth(BitsPerChannelType.SIXTEEN);try{var scp = "app.document.getSelection();";//var scp += "for(t = 0; t < thumbs.length; t++){names += thumbs[t].path;}";var canvasRef = canvas.initCanvas();/*var pmsg = "var bt = new BridgeTalk();";pmsg += "bt.target = 'photoshop';";pmsg += "bt.body = app.document.getSelection().toString();";pmsg += "bt.send();";*/var bt = new BridgeTalk();var targetApp = BridgeTalk.getSpecifier("bridge-5");bt.target = targetApp;bt.onResult = function(retVal){  //alert('result');  //CSGlobal.csDebug(1,'result');  var names = '';  var thumbs = eval(retVal.body);  for(t = 0; t < thumbs.length; t++)  {    alert(thumbs[t]);    names += thumbs[t].path;  }  //CSGlobal.csDebug(1,sel);  //alert(names);}bt.body = scp;bt.send();}catch (e){  CSGlobal.csDebug(1,e.message);}