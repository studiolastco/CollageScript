var myDocument = app.activeDocument;var thePath = myDocument.path;CSGlobal.csDebug(1,'Active Document: ' + myDocument);for (var j = 0; j < myDocument.artLayers.length; j++)   {    var visibility = myDocument.artLayers[j].visible;    CSGlobal.csDebug(1,myDocument.artLayers[j] + ' visibility:' + visibility);        myDocument.activeLayer = myDocument.artLayers[j];    var theLayer = myDocument.artLayers[j];    CSGlobal.csDebug(1,'Active Layer: ' + theLayer.name);        var smartDocument = openSmartObject (theLayer);}function openSmartObject (theLayer){   if (theLayer.kind == "LayerKind.SMARTOBJECT")   {      var idplacedLayerEditContents = stringIDToTypeID( "placedLayerEditContents" );      var desc2 = new ActionDescriptor();       // why does this line here throw errors sometimes, and sometimes not.      executeAction( idplacedLayerEditContents, desc2, DialogModes.NO );      if (!visibility)      {       CSGlobal.csDebug(1,'Layer was hidden.');      }      theLayer.visible = visibility;   };   return app.activeDocument};