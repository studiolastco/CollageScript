var NEWSRCDIR = '/Users/calhoun/Work/KAP/tree-003';var FFORMAT = 'CR2';var myDocument = app.activeDocument;var thePath = myDocument.path;CSGlobal.csDebug(1,'Active Document: ' + myDocument);for (var j = 0; j < myDocument.artLayers.length; j++)   {  myDocument.activeLayer = myDocument.artLayers[j];  var theLayer = myDocument.artLayers[j];  CSGlobal.csDebug(1,'Active Layer: ' + theLayer.name);  var newFileName = NEWSRCDIR + '/' + theLayer.name + '.' + FFORMAT;  CSGlobal.csDebug(1,'Replacement Content: ' + newFileName);  theLayer = replaceSO(newFileName);}////// see http://forums.adobe.com/message/3946520 /////  ////// replace contents //////function replaceContents (newFileName) {// =======================================================var idplacedLayerReplaceContents = stringIDToTypeID( "placedLayerReplaceContents" );    var desc3 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );   desc3.putPath( idnull, new File( newFileName ) );    //var idPgNm = charIDToTypeID( "PgNm" );    //desc3.putInteger( idPgNm, 1 );executeAction( idplacedLayerReplaceContents, desc3, DialogModes.NO);return app.activeDocument.activeLayer};    function replaceSO (newFile) {        var id = stringIDToTypeID( "placedLayerReplaceContents" );        var desc = new ActionDescriptor();        var idn = charIDToTypeID("null");        desc.putPath( idn, new File(newFile));        var idp = charIDToTypeID("PgNm");        desc.putInteger(idp, 1);        executeAction(id, desc, DialogModes.NO);        return app.activeDocument.activeLayer    };