var NEWSRCDIR = '/Users/cal/Work/KAP/tree-002';var FFORMAT = 'CR2';var myDocument = app.activeDocument;var thePath = myDocument.path;CSGlobal.csDebug(1,'Active Document: ' + myDocument);       if ( !ExternalObject.AdobeXMPScript ){           try{              //ExternalObject.AdobeXMPScript = new ExternalObject('lib:AdobeXMPScript');               alert("loaded");           }catch (e){               alert("Can't load XMP Script Library");               //return false;           }       }       //return true;       for (var j = 0; j < myDocument.artLayers.length; j++)   {  myDocument.activeLayer = myDocument.artLayers[j];  var theLayer = myDocument.artLayers[j];  CSGlobal.csDebug(1,'Active Layer: ' + theLayer.name);  //var newFileName = NEWSRCDIR + '/' + theLayer.name + '.' + FFORMAT;  var xmp = new XMPMeta( app.theLayer.xmpMetadata.rawData );  CSGlobal.csDebug(1,'xmp ' + xmp);  //theLayer = replaceContents(newFileName);}////// see http://forums.adobe.com/message/3946520 /////  ////// replace contents //////function replaceContents (newFileName) {// =======================================================var idplacedLayerReplaceContents = stringIDToTypeID( "placedLayerReplaceContents" );    var desc3 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );    desc3.putPath( idnull, new File( newFileName ) );    //var idPgNm = charIDToTypeID( "PgNm" );    //desc3.putInteger( idPgNm, 1 );executeAction( idplacedLayerReplaceContents, desc3, DialogModes.NO);return app.activeDocument.activeLayer};