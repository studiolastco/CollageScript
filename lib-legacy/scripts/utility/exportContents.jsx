#include "../../Include.jsx";CSGlobal.setDebugLevel(1);var NEWSRCDIR = '/Users/cal/Work/Tanguy/export';var FFORMAT = 'CR2';var myDocument = app.activeDocument;var thePath = myDocument.path;CSGlobal.csDebug(1,'Active Document: ' + myDocument);for (var j = 0; j < myDocument.artLayers.length; j++) {  myDocument.activeLayer = myDocument.artLayers[j];  var theLayer = myDocument.artLayers[j];  CSGlobal.csDebug(1,'Active Layer: ' + theLayer.name);  var newFileName = NEWSRCDIR + '/' + theLayer.name + '.' + FFORMAT;  CSGlobal.csDebug(1,'Exported Content: ' + newFileName);  theLayer = replaceContents(newFileName);}////// see http://forums.adobe.com/message/3946520 ///////////http://www.ps-scripts.com/bb/viewtopic.php?p=6473&sid=84ccb349558bcc2e65ca8243724c4875//////////// replace contents //////function replaceContents (fileRefStr) {// =======================================================//var idplacedLayerExportContents = stringIDToTypeID( "placedLayerExportContents" );    //var desc3 = new ActionDescriptor();    //var idnull = charIDToTypeID( "null" );    //desc.putPath( charIDToTypeID( "null" ), new File( fileRefStr ) );                      //var desc = new ActionDescriptor();       //desc.putPath( charIDToTypeID( "null" ), new File( fileRefStr ) );       executeAction( stringIDToTypeID( "placedLayerExportContents" ), undefined, DialogModes.NO );    //desc3.putPath( idnull);    //var idPgNm = charIDToTypeID( "PgNm" );    //desc3.putInteger( idPgNm, 1 );//executeAction( idplacedLayerExportContents, idnull, DialogModes.NO);return app.activeDocument.activeLayer};